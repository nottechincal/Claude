{
  "tools": [
    {
      "type": "function",
      "function": {
        "name": "checkOpen",
        "description": "Check if the shop is currently open for business. Returns opening status and hours.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "validateMenuItem",
        "description": "Validate that a menu item configuration is valid before adding to cart. Prevents fake/invalid orders.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "category": {
              "type": "string",
              "description": "Item category to validate",
              "enum": ["kebabs", "hsp", "chips", "drinks", "gozleme", "sweets", "extras", "sauce_tubs"]
            },
            "size": {
              "type": "string",
              "description": "Size to validate (if applicable)",
              "enum": ["small", "large"]
            },
            "protein": {
              "type": "string",
              "description": "Protein type to validate (for kebabs/hsp)",
              "enum": ["lamb", "chicken", "mixed", "falafel"]
            }
          },
          "required": ["category"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "repeatLastOrder",
        "description": "Copy customer's last order to cart for fast reordering. Great for regular customers.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "phoneNumber": {
              "type": "string",
              "description": "Customer's phone number to look up last order"
            }
          },
          "required": ["phoneNumber"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "getMenuByCategory",
        "description": "Browse menu items by category. If no category provided, returns list of all categories.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "category": {
              "type": "string",
              "description": "Category to browse. Leave empty to get list of all categories."
            }
          },
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "getCallerInfo",
        "description": "Silently retrieve caller's phone number from call context. Use at start of call.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "getCallerSmartContext",
        "description": "⚡ NEW: Get enhanced caller info with order history, favorite items, and smart greeting suggestions. Use this instead of getCallerInfo for returning customers. Provides personalized experience with pattern analysis.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "startItemConfiguration",
        "description": "Start configuring a new menu item. Call this when customer mentions an item.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "category": {
              "type": "string",
              "description": "Item category: kebabs, hsp, chips, drinks, gozleme, sweets, extras, sauce_tubs",
              "enum": ["kebabs", "hsp", "chips", "drinks", "gozleme", "sweets", "extras", "sauce_tubs"]
            },
            "name": {
              "type": "string",
              "description": "Specific item name if known (e.g., 'Chicken Kebab', 'Lamb HSP')"
            }
          },
          "required": ["category"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "setItemProperty",
        "description": "Set a property on the item currently being configured (size, protein, salads, sauces, extras, etc.)",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "field": {
              "type": "string",
              "description": "Property name to set",
              "enum": ["size", "protein", "salads", "sauces", "extras", "cheese", "brand", "variant", "salt_type", "sauce_type", "quantity"]
            },
            "value": {
              "description": "Value to set. Can be string, array, boolean, or number depending on field."
            }
          },
          "required": ["field", "value"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "addItemToCart",
        "description": "Add the fully configured item to cart. Automatically detects combo opportunities.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "addMultipleItemsToCart",
        "description": "⚡ NEW: Add multiple items to cart in one call for 60-70% faster ordering. Perfect for customers who know what they want. Accepts array of fully configured items with all properties set.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "items": {
              "type": "array",
              "description": "Array of items to add to cart. Each item should have: category, size, protein (if applicable), salads, sauces, quantity, etc.",
              "items": {
                "type": "object",
                "properties": {
                  "category": {"type": "string", "description": "Item category"},
                  "size": {"type": "string", "description": "Size: small or large"},
                  "protein": {"type": "string", "description": "Protein: lamb, chicken, mixed, falafel"},
                  "salads": {"type": "array", "items": {"type": "string"}, "description": "Array of salad toppings"},
                  "sauces": {"type": "array", "items": {"type": "string"}, "description": "Array of sauces"},
                  "extras": {"type": "array", "items": {"type": "string"}, "description": "Extra toppings like haloumi"},
                  "cheese": {"type": "boolean", "description": "Add extra cheese"},
                  "quantity": {"type": "number", "description": "Quantity to add"},
                  "brand": {"type": "string", "description": "Brand for drinks"},
                  "salt_type": {"type": "string", "description": "Salt type for chips: chicken, sea, none"},
                  "notes": {"type": "string", "description": "Special instructions"}
                },
                "required": ["category"]
              }
            }
          },
          "required": ["items"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "quickAddItem",
        "description": "⚡ NEW: Smart NLP parser that adds items from natural language description. Handles phrases like '2 large lamb kebabs with extra garlic sauce' or 'large chips with chicken salt'. 40-50% faster for simple orders. Falls back to guided flow if unable to parse.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "description": {
              "type": "string",
              "description": "Natural language description of item(s) to add. Examples: 'large lamb kebab with garlic sauce', '2 cokes', 'small chicken hsp with no salad'"
            }
          },
          "required": ["description"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "getCartState",
        "description": "Get current cart contents and state.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "removeCartItem",
        "description": "Remove an item from the cart by index. Use getCartState first to see cart items and their indexes (0-based).",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "itemIndex": {
              "type": "number",
              "description": "Zero-based index of item to remove (0 for first item, 1 for second, etc.)"
            }
          },
          "required": ["itemIndex"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "editCartItem",
        "description": "Edit an existing cart item's properties (salads, sauces, extras, cheese, salt_type, quantity). Cannot change size or protein - remove and re-add instead.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "itemIndex": {
              "type": "number",
              "description": "Zero-based index of item to edit"
            },
            "field": {
              "type": "string",
              "description": "Field to edit: salads, sauces, extras, cheese, salt_type, quantity",
              "enum": ["salads", "sauces", "extras", "cheese", "salt_type", "quantity"]
            },
            "value": {
              "description": "New value for the field"
            }
          },
          "required": ["itemIndex", "field", "value"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "clearCart",
        "description": "Clear all items from cart. Use when customer wants to start over.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "convertItemsToMeals",
        "description": "Convert kebabs in cart to meals (kebab + chips + drink). Can convert all kebabs or specific items by index. Use when customer says 'make them all meals' or 'upgrade to meals'.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "itemIndices": {
              "type": "array",
              "items": {
                "type": "number"
              },
              "description": "Optional: specific cart item indices to convert (0-based). If not provided, converts ALL kebabs in cart."
            },
            "drinkBrand": {
              "type": "string",
              "description": "Drink choice for the meal: coke, sprite, fanta, etc. Default: coke",
              "default": "coke"
            },
            "chipsSize": {
              "type": "string",
              "description": "Chips size: small or large. Default: small",
              "enum": ["small", "large"],
              "default": "small"
            },
            "chipsSalt": {
              "type": "string",
              "description": "Salt type for chips: chicken, plain, or seasoned. Default: chicken",
              "enum": ["chicken", "plain", "seasoned"],
              "default": "chicken"
            }
          },
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "modifyCartItem",
        "description": "Modify any property of an existing cart item including size, protein, salads, sauces, etc. Unlike editCartItem, this can change ANY field.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "itemIndex": {
              "type": "number",
              "description": "Zero-based index of item to modify"
            },
            "modifications": {
              "type": "object",
              "description": "Object containing fields to modify and their new values. Example: {\"salads\": [\"tomato\", \"lettuce\"], \"sauces\": [\"garlic\"], \"size\": \"large\"}"
            }
          },
          "required": ["itemIndex", "modifications"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "getDetailedCart",
        "description": "Get detailed human-readable cart with descriptions and modifiers for each item. Better than getCartState for reviewing order with customer.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "clearSession",
        "description": "Reset entire session (cart, config, state). Use for testing or complete restart.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "priceCart",
        "description": "Calculate total price for all items in cart with detailed breakdown.",
        "strict": true,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "estimateReadyTime",
        "description": "Estimate when order will be ready for pickup based on current queue.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {
            "requestedTime": {
              "type": "string",
              "description": "Optional: Customer's requested time (e.g., 'in 30 minutes', '6 PM')"
            }
          },
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "createOrder",
        "description": "Create and save the final order to database.",
        "strict": true,
        "parameters": {
          "type": "object",
          "properties": {
            "customerName": {
              "type": "string",
              "description": "Customer's name for the order"
            },
            "customerPhone": {
              "type": "string",
              "description": "Customer's phone number (from getCallerInfo)"
            },
            "readyAtIso": {
              "type": "string",
              "description": "ISO timestamp when order will be ready (from estimateReadyTime)"
            }
          },
          "required": ["customerName", "customerPhone", "readyAtIso"]
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    },
    {
      "type": "function",
      "function": {
        "name": "endCall",
        "description": "End the phone call gracefully after order completion.",
        "strict": false,
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      },
      "async": false,
      "server": {
        "url": "YOUR_WEBHOOK_URL_HERE/webhook"
      }
    }
  ]
}
